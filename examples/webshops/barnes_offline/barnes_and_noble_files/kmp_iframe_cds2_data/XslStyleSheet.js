var xslStyleSheet="<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"><xsl:output method=\"html\" omit-xml-declaration=\"yes\"/><xsl:variable name=\"IMAGEHOST\" select=\"'http://images.barnesandnoble.com'\"/><xsl:variable name=\"shophost\" select=\"//Product/shophost\"/><xsl:variable name=\"slinkprefix\" select=\"//Product/slinkprefix\"/><xsl:variable name=\"itemadded\" select=\"//Product/itemadded\"/><xsl:template match=\"//Product\"><xsl:variable name=\"params\" select=\"params\"/><xsl:variable name=\"URL\"><xsl:choose><xsl:when test=\"string-length($params)&gt;0\"><xsl:choose><xsl:when test=\"contains(//Product/shophost,'btobshop2')\"><xsl:value-of select=\"concat('http://btob', substring-before(substring-after(URL, 'http://'),'?'),$params,'&amp;pvsrc=1')\"/></xsl:when><xsl:otherwise><xsl:value-of select=\"concat(substring-before(URL,'?'),$params,'&amp;pvsrc=1')\"/></xsl:otherwise></xsl:choose></xsl:when><xsl:otherwise><xsl:choose><xsl:when test=\"contains(//Product/shophost,'btobshop2')\"><xsl:value-of select=\"concat('http://btob', substring-before(substring-after(URL, 'http://'),'?'),'&amp;pvsrc=1')\"/></xsl:when><xsl:otherwise><xsl:value-of select=\"concat(URL, '&amp;pvsrc=1')\"/></xsl:otherwise></xsl:choose></xsl:otherwise></xsl:choose></xsl:variable><table width=\"100%\" id=\"textLinkPreview\" cellpadding=\"5\" cellspacing=\"0\"><tr valign=\"top\"><td id=\"imageThumb\"><a href=\"{$URL}\"><img border=\"0\"><xsl:choose><xsl:when test=\"ProductPageImageURL!=''\"><xsl:attribute name=\"src\"><xsl:value-of select=\"ProductPageImageURL\"/></xsl:attribute><xsl:call-template name=\"scaleProductImage\"><xsl:with-param name=\"width\" select=\"ProductPageImageWidth\"/><xsl:with-param name=\"height\" select=\"ProductPageImageHeight\"/></xsl:call-template><xsl:attribute name=\"alt\"><xsl:value-of select=\"Title\"/></xsl:attribute></xsl:when><xsl:otherwise><xsl:attribute name=\"src\"><xsl:value-of select=\"concat($IMAGEHOST, '/pimages/gresources/ImageNA.gif')\"/></xsl:attribute><xsl:attribute name=\"alt\"><xsl:value-of select=\"'Image Unavailable'\"/></xsl:attribute></xsl:otherwise></xsl:choose></img></a><a class=\"seeDetails\" href=\"{$URL}\">See Details</a></td><td id=\"productDetails\"><ul><li class=\"productTitle\"><a href=\"{$URL}\"><xsl:value-of select=\"Title\"/></a></li><xsl:choose><xsl:when test=\"ProductType='Music'\"><xsl:if test=\"Contributors/Contributor[starts-with(Job,'Primary Artist')]\"><li><xsl:value-of select=\"Contributors/Contributor[starts-with(Job,'Primary Artist')]/ContributorName\"/></li></xsl:if></xsl:when><xsl:when test=\"ProductType='Book'\"><li><xsl:value-of select=\"Contributors/Contributor/ContributorName\"/></li></xsl:when></xsl:choose><xsl:if test=\"not(ProductType='Video') and string-length(FormatDescription)>0 and not(starts-with(FormatDescription,'Other'))\"><li class=\"previewFormat\">Format: <strong><xsl:value-of select=\"FormatDescription\" /></strong></li></xsl:if><xsl:if test=\"ProductType='Video'\"><li class=\"previewFormat\">Format: <strong><xsl:value-of select=\"FormatCode\" /></strong></li></xsl:if><li>Online Price: <strong><xsl:value-of select=\"format-number(BNPrice,'$#.00')\" /></strong></li><xsl:if test=\"BNMemberPrice and not(contains(//Product/shophost,'btobshop2'))\"><li>Members Pay: <strong><xsl:value-of select=\"format-number(BNMemberPrice,'$#.00')\" /></strong></li></xsl:if><xsl:if test=\"BNCustomerRating&gt;1\"><li><span class=\"customerRating\">Customer Rating: </span><xsl:call-template name=\"ratingRenderImage\"><xsl:with-param name=\"number\" select=\"BNCustomerRating\"/></xsl:call-template></li></xsl:if><xsl:if test=\"string-length(DeliveryTime)>0\"><li id=\"deliveryMessage\" class=\"deliveryMessage\"><xsl:value-of select=\"DeliveryTime\" disable-output-escaping=\"yes\" /></li></xsl:if></ul><xsl:if test=\"string-length($shophost)&gt;0 and AvailableForSale='true'\"><xsl:call-template name=\"renderAddToCartBtn\"></xsl:call-template></xsl:if></td></tr></table></xsl:template><xsl:template name=\"ratingRenderImage\"><xsl:param name=\"number\"/><img align=\"middle\" width=\"68\" height=\"17\" border=\"0\" hspace=\"5\"><xsl:attribute name=\"src\"><xsl:value-of select=\"concat($IMAGEHOST, '/pimages/productpages/', $number, '_circles.gif')\"/></xsl:attribute><xsl:attribute name=\"alt\"><xsl:text>Customer Rating </xsl:text><xsl:value-of select=\"$number\"/><xsl:text> out of 5</xsl:text></xsl:attribute></img></xsl:template><xsl:template name=\"scaleProductImage\"><xsl:param name=\"width\"/><xsl:param name=\"height\"/><xsl:variable name=\"Scale\"><xsl:choose><xsl:when test=\"$width &gt; 80\"><xsl:value-of select=\"80 div $width\"/></xsl:when><xsl:otherwise><xsl:value-of select=\"1\"/></xsl:otherwise></xsl:choose></xsl:variable><xsl:attribute name=\"width\"><xsl:value-of select=\"round($width * $Scale)\"/></xsl:attribute><xsl:attribute name=\"height\"><xsl:value-of select=\"round($height * $Scale)\"/></xsl:attribute></xsl:template><xsl:template name=\"renderAddToCartBtn\"><xsl:choose><xsl:when test=\"$itemadded='y'\"><a class=\"cartBtn\"><xsl:attribute name=\"href\"><xsl:value-of select=\"concat('http://',$shophost,'/shop/op.asp?step=fullCart&amp;UIAction=editCart&amp;',$slinkprefix)\"/></xsl:attribute><img><xsl:attribute name=\"src\"><xsl:value-of select=\"concat($IMAGEHOST,'/pimages/gresources/product/btn_ItemAdded.gif')\"/></xsl:attribute></img></a></xsl:when><xsl:otherwise><form method=\"post\"><xsl:attribute name=\"action\"><xsl:value-of select=\"concat('http://',$shophost,'/Shop/xt_manage_cart.asp','?',$slinkprefix)\"/></xsl:attribute><input type=\"hidden\"><xsl:attribute name=\"name\">productcode</xsl:attribute><xsl:attribute name=\"value\"><xsl:value-of select=\"ProductCode\"/></xsl:attribute></input><input type=\"hidden\"><xsl:attribute name=\"name\">ean</xsl:attribute><xsl:attribute name=\"value\"><xsl:value-of select=\"EAN\"/></xsl:attribute></input><input type=\"image\" class=\"cartBtn\"><xsl:attribute name=\"src\"><xsl:value-of select=\"concat($IMAGEHOST,'/pimages/gresources/product/AddtoCart_Dots3.gif')\"/></xsl:attribute></input></form></xsl:otherwise></xsl:choose></xsl:template></xsl:stylesheet>"